<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Chek-in - Insta-Wealth</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-orange: #f09433;
            --white: #ffffff;
            --bg-body: #f4f7f8;
            --ig-gradient: linear-gradient(45deg, #f09433, #e6683c, #dc2743, #cc2366, #bc1888);
        }

        @keyframes popIn {
            0% { transform: scale(0.9); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        .animate { animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }

        * {
            margin: 0; padding: 0; box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        body { background-color: var(--bg-body); display: flex; justify-content: center; color: #333; }

        .app-container {
            width: 100%; max-width: 414px; background-color: var(--white);
            min-height: 100vh; position: relative; padding-bottom: 40px;
            box-shadow: 0 0 20px rgba(0,0,0,0.05);
        }

        /* --- Header --- */
        .header {
            padding: 15px 20px; display: flex; align-items: center; justify-content: space-between;
            background: var(--white); position: sticky; top: 0; z-index: 1000; border-bottom: 1px solid #f0f0f0;
        }
        .back-box {
            width: 38px; height: 38px; background: #ffffff; border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            border: 1.5px solid #ebebeb; cursor: pointer;
        }
        .header-title {
            flex: 1; text-align: center; font-weight: 700; font-size: 17px;
            background: var(--ig-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .spacer { width: 38px; }

        .content-padding { padding: 25px 16px; }

        .info-text { margin-bottom: 25px; text-align: center; }
        .info-text h3 { font-size: 18px; font-weight: 700; margin-bottom: 5px; }
        .info-text p { font-size: 12px; color: #777; }

        /* --- Calendar Grid --- */
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }

        .date-item {
            border-radius: 20px; padding: 25px 10px;
            text-align: center; transition: 0.3s;
            display: flex; flex-direction: column; align-items: center;
            color: white; box-shadow: 0 8px 15px rgba(0,0,0,0.1);
        }

        /* Warna Gradasi */
        .c1 { background: linear-gradient(135deg, #667eea, #764ba2); }
        .c2 { background: linear-gradient(135deg, #f093fb, #f5576c); }
        .c3 { background: linear-gradient(135deg, #4facfe, #00f2fe); }
        .c4 { background: linear-gradient(135deg, #43e97b, #38f9d7); }
        .c5 { background: linear-gradient(135deg, #fa709a, #fee140); }
        .c6 { background: linear-gradient(135deg, #30cfd0, #330867); }

        /* Hari ke 7 Mewah */
        .date-item.day-7 {
            grid-column: span 3;
            background: var(--ig-gradient);
            padding: 20px;
            flex-direction: row;
            justify-content: space-around;
        }

        .day-num { font-size: 11px; font-weight: 600; opacity: 0.8; }
        .reward { font-size: 14px; font-weight: 700; margin-top: 5px; }

        .status-badge {
            margin-top: 10px; font-size: 10px; font-weight: 700;
            background: rgba(255,255,255,0.25);
            padding: 4px 10px; border-radius: 10px;
        }

        .check-mark { margin-top: 10px; font-size: 16px; }

        .btn-main-claim {
            width: 100%; background: var(--ig-gradient); color: white;
            border: none; padding: 18px; border-radius: 18px;
            font-size: 16px; font-weight: 600; margin-top: 35px;
            cursor: pointer; box-shadow: 0 10px 20px rgba(220, 39, 67, 0.2);
        }
        /* Overlay Check-in */
.checkin-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0); display: flex; justify-content: center; align-items: center;
    visibility: hidden; opacity: 0; transition: all 0.5s ease;
    z-index: 5000;
}

.checkin-overlay.show {
    visibility: visible;
    opacity: 1;
    background: rgba(0,0,0,0.5);
}

.checkin-box {
    max-width: 360px; width: 88%; padding: 30px 25px;
    border-radius: 28px; background: var(--ig-gradient);
    color: #fff; text-align: center;
    font-weight: 700; font-size: 18px;
    box-shadow: 0 15px 40px rgba(0,0,0,0.3);
    animation: popIn 0.5s forwards;
}
    </style>
</head>
<body>

<div class="app-container">
    <header class="header">
        <div class="back-box" onclick="window.history.back()">
            <i class="fas fa-chevron-left"></i>
        </div>
        <span class="header-title">Check-in Harian</span>
        <div class="spacer"></div>
    </header>

    <div class="content-padding">
        <div class="info-text animate">
            <h3>Klaim Hadiah Anda</h3>
            <p>Check-in setiap hari untuk mendapatkan saldo gratis</p>
        </div>

        <div class="calendar-grid">
<div class="date-item c1 animate">
    <span class="day-num">Hari ke 1</span>
    <span class="reward">Rp 1.000</span>
    <i class="fas fa-gift check-mark" style="opacity:0.4"></i>
</div>

            <div class="date-item c2 animate" style="animation-delay: 0.2s;">
                <span class="day-num">Hari ke 2</span>
                <span class="reward">Rp 1.000</span>
                <i class="fas fa-gift check-mark" style="opacity: 0.4;"></i>
            </div>

            <div class="date-item c3 animate" style="animation-delay: 0.3s;">
                <span class="day-num">Hari ke 3</span>
                <span class="reward">Rp 1.000</span>
                <i class="fas fa-gift check-mark" style="opacity: 0.4;"></i>
            </div>

            <div class="date-item c4 animate" style="animation-delay: 0.4s;">
                <span class="day-num">Hari ke 4</span>
                <span class="reward">Rp 1.000</span>
                <i class="fas fa-gift check-mark" style="opacity: 0.4;"></i>
            </div>

            <div class="date-item c5 animate" style="animation-delay: 0.5s;">
                <span class="day-num">Hari ke 5</span>
                <span class="reward">Rp 1.000</span>
                <i class="fas fa-gift check-mark" style="opacity: 0.4;"></i>
            </div>

            <div class="date-item c6 animate" style="animation-delay: 0.6s;">
                <span class="day-num">Hari ke 6</span>
                <span class="reward">Rp 1.000</span>
                <i class="fas fa-gift check-mark" style="opacity: 0.4;"></i>
            </div>

            <div class="date-item day-7 animate" style="animation-delay: 0.7s;">
                <div style="text-align: left;">
                    <span class="day-num" style="font-size: 13px;">HARI KE 7</span>
                    <span class="reward" style="display: block; font-size: 20px;">Rp 5.000</span>
                </div>
                <i class="fas fa-crown" style="font-size: 35px; color: #ffd700;"></i>
            </div>
        </div>

        <button class="btn-main-claim" onclick="klaimCheckin()">
    Klaim Sekarang
</button>
    </div>
</div>
<script>
/* ===============================
   VALIDASI LOGIN
================================ */
if (localStorage.getItem("APP_LOGIN") !== "true") {
    location.href = "daftar-masuk.html";
}

const users = JSON.parse(localStorage.getItem("APP_USERS")) || [];
const loginIndex = Number(localStorage.getItem("APP_LOGIN_INDEX"));
const user = users[loginIndex];

if (!user) {
    alert("Silakan login ulang");
    location.href = "daftar-masuk.html";
}

/* ===============================
   PASTIKAN STRUKTUR DATA
================================ */
if (!user.saldo) {
    user.saldo = { penarikan: 0 };
}

if (!user.transaksi) {
    user.transaksi = [];
}

if (!user.checkin) {
    user.checkin = {
        hariKe: 0,
        terakhir: 0
    };
}

/* ===============================
   UTIL
================================ */
function saveUser() {
    users[loginIndex] = user;
    localStorage.setItem("APP_USERS", JSON.stringify(users));
}

function isSameDay(t1, t2) {
    const d1 = new Date(t1);
    const d2 = new Date(t2);
    return d1.toDateString() === d2.toDateString();
}

/* ===============================
   RENDER CHECKIN UI
================================ */
function renderCheckin() {
    const items = document.querySelectorAll(".date-item");
    const btn = document.querySelector(".btn-main-claim");

    items.forEach((item, i) => {
        item.classList.remove("claimed");
        item.innerHTML = item.innerHTML.replace(
            /<span class="status-badge">Berhasil<\/span>/g, ""
        );
    });

    for (let i = 0; i < user.checkin.hariKe; i++) {
    const el = items[i];
    if (!el) continue;

    const gift = el.querySelector(".fa-gift");
    if (gift) gift.remove();

    el.innerHTML += `
        <i class="fas fa-check-circle check-mark"></i>
        <span class="status-badge">Berhasil</span>
    `;
}

    if (user.checkin.terakhir && isSameDay(user.checkin.terakhir, Date.now())) {
        btn.innerText = "Sudah Check-in Hari Ini";
        btn.disabled = true;
        btn.style.opacity = 0.6;
    }
}

/* ===============================
   KLAIM CHECKIN
================================ */
function klaimCheckin() {
    const btn = document.querySelector(".btn-main-claim");

    if (user.checkin.terakhir && isSameDay(user.checkin.terakhir, Date.now())) {
        alert("Anda sudah check-in hari ini");
        return;
    }

    let reward = 1000;
    user.checkin.hariKe++;

    if (user.checkin.hariKe === 7) reward = 5000;

    user.saldo.penarikan += reward;
    user.checkin.terakhir = Date.now();

    user.transaksi.unshift({
        id: "TRX-" + Date.now(),
        jenis: "kas",
        keterangan: "Check-in Hari ke " + user.checkin.hariKe,
        jumlah: reward,
        status: "Berhasil",
        tanggal: new Date().toLocaleString("id-ID"),
        time: Date.now()
    });

    if (user.checkin.hariKe >= 7) {
        user.checkin.hariKe = 0;
        user.checkin.terakhir = 0;
    }

    saveUser();
    renderCheckin();

    btn.innerText = "Berhasil Diklaim";
    btn.disabled = true;
    btn.style.opacity = 0.6;

    // --- Tampilkan overlay ---
    const overlay = document.getElementById("checkinOverlay");
    const message = document.getElementById("checkinMessage");
    message.innerText = `Berhasil klaim Rp ${reward.toLocaleString()}`;
    overlay.classList.add("show");

    // Hilangkan overlay setelah 2.5 detik
    setTimeout(() => {
        overlay.classList.remove("show");
    }, 2500);
}

/* ===============================
   INIT
================================ */
renderCheckin();
</script>
<!-- Overlay Check-in -->
<div class="checkin-overlay" id="checkinOverlay">
    <div class="checkin-box" id="checkinMessage">
        Berhasil Klaim Check-in!
    </div>
</div>
</body>
</html>